<!DOCTYPE html>
<html>
  <body>
    <canvas
      id="myCanvas"
      width="1000"
      height="1000"
      style="border: 3px solid #d3d3d3"
    >
      Your browser does not support the HTML5 canvas tag.
    </canvas>

    <script src="../../../lib/gl-matrix-3.3.0.min.js"></script>
    <script src="bz-spline.js"></script>

    <script>
      "use strict";

      function dibujarVector(x1, y1, x2, y2, color) {
        ctx.beginPath();
        ctx.moveTo(x1, y1);
        ctx.lineTo(x1 + x2, y1 + y2);
        ctx.strokeStyle = color;
        ctx.stroke();
      }

      function animate() {
        requestAnimationFrame(animate);

        ctx.clearRect(0, 0, 1000, 1000);
        spline.canvasDraw(ctx, true, 0.2);

        const { p: punto, t, n } = spline.point(currentU);

        // dibujar punto de la curva en verde
        currentU += 0.002;
        ctx.lineWidth = 5;
        ctx.beginPath();
        ctx.arc(punto[0], punto[1], 10, 0, 2 * Math.PI);
        ctx.strokeStyle = "#00F";
        ctx.stroke();

        dibujarVector(punto[0], punto[1], t[0] * 50, t[1] * 50, "#F00");
        dibujarVector(punto[0], punto[1], n[0] * 50, n[1] * 50, "#0F0");

        if (currentU > 1) currentU = 0;
      }

      var puntos = [
        [0, 0, 0],
        [0, 200, 0],
        [200, 200, 0],
        [200, 100, 0],
        [200, 0, 0],
        [400, 0, 0],
        [400, 200, 0],
        [400, 400, 0],
        [200, 400, 0],
        [200, 200, 0],
      ];

      var spline = new Spline(puntos);

      var currentU = 0;

      var c = document.getElementById("myCanvas");
      var ctx = c.getContext("2d");

      animate();
    </script>
  </body>
</html>
